<!DOCTYPE html>
<html lang="en">
<head>
	<script src="/socket.io/socket.io.js"></script>
    <script src="https://npmcdn.com/babel-core@5.8.38/browser.min.js"></script>
    <script type="text/babel" >
        "use strict";
    	
		let socket;
		let canvas;
		let ctx;
		let draws = {};

/*let mouseX = e.pageX - this.offsetLeft;
let mouseY = e.pageY - this.offsetTop;*/

		const handleMessage = (data) => {
			draws[data.time] = data.coords;
			draw();
		}

		const draw = () => {			
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			
			let keys = Object.keys(draws);
			
			for(let i = 0; i < keys.length; i++) {
				const drawCall = draws[keys[i]];
				
				ctx.fillRect(drawCall.x, drawCall.y, drawCall.width, drawCall.height);
			}
		}

		const init = () => {
			ctx = document.getElementById('canvas').getContext("2d");
			canvas = document.querySelector("#click");
			canvas.addEventListener('click', draw);
			
			socket = io.connect();
			socket.on('updated', handleMessage);
		}

		window.onload = init;
    </script>
</head>
<body>
	<canvas id="canvas" width="500" height="500" style="border:1px solid #000000;"></canvas>
</body>
</html>